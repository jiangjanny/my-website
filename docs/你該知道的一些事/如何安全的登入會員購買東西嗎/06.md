---
slug: 什麼是持久型XSS攻擊？
title: 什麼是持久型XSS攻擊？
authors:
    name: Janny
    title: 什麼是持久型XSS攻擊？
    url: https://github.com/jiangjanny
    image_url: https://avatars.githubusercontent.com/u/109901097?s=96&v=4
tags: [InternetSecurity, XSS, 非持久型XSS]
---


## 持久型XSS是 存儲型（Persistent XSS）

Stored把XSS存在伺服器XSS是存在URL所以攻擊者把惡意程式碼提交到伺服器上

存儲型 XSS（Stored Cross-Site Scripting），又稱持久型 XSS，是一種較為嚴重的 XSS 攻擊類型。這種攻擊發生在服務器端，攻擊者將惡意腳本注入到存儲在目標網站後端的數據中，例如數據庫、日誌文件等。當其他用戶訪問受影響的頁面時，惡意腳本會自動在他們的瀏覽器中執行。

### 攻擊過程

存儲型 XSS 攻擊的典型過程如下：

1. **攻擊者注入惡意腳本**：
攻擊者通過提交表單、發表評論、上傳文件等方式，將惡意腳本注入到網站的數據存儲區，例如：
    
    ```html
    <script>alert('XSS')</script>
    ```
    
2. **服務器存儲惡意腳本**：
網站將用戶提交的數據（包括惡意腳本）存儲在數據庫或其他後端存儲中，沒有進行適當的過濾和處理。
3. **其他用戶訪問受感染頁面**：
當其他用戶訪問顯示這些數據的頁面時，存儲在後端的惡意腳本會被嵌入到網頁中並在用戶的瀏覽器中執行。
4. **攻擊效果**：
執行的惡意腳本可以執行各種操作，例如竊取用戶的 Cookie、竊取敏感數據、劫持使用者會話、發送未經授權的請求等。

### 示例

假設一個博客網站允許用戶發表評論，並將評論存儲在數據庫中，而沒有對用戶提交的數據進行過濾。攻擊者可以提交如下評論：

```html
Great post! <script>alert('XSS')</script>

```

當其他用戶訪問該博客文章時，這段惡意腳本將在他們的瀏覽器中執行。

### 預防措施

為了防止存儲型 XSS 攻擊，可以採取以下措施：

1. **輸入驗證與清理**：
對所有用戶輸入的數據進行嚴格的驗證和過濾，確保不包含任何惡意腳本。
2. **輸出編碼**：
在輸出到瀏覽器之前，對所有用戶輸入的數據進行編碼，這樣即使包含惡意腳本，也不會被瀏覽器當作可執行代碼處理。
3. **使用安全的函數庫**：
使用安全框架或函數庫來處理用戶輸入，例如 OWASP 的 AntiSamy、ESAPI 等。
4. **設置安全標頭**：
配置 HTTP 安全標頭（如 Content Security Policy, X-XSS-Protection）來防止瀏覽器執行未經授權的腳本。
5. **定期審查和更新代碼**：
定期審查和更新應用程序代碼，確保符合最新的安全標準和最佳實踐。
6. **使用富文本編輯器**：
如果允許用戶輸入 HTML，使用經過安全審查的富文本編輯器來限制允許的 HTML 標籤和屬性。

通過採取這些措施，可以有效地減少存儲型 XSS 攻擊的風險，保護網站和用戶的安全。